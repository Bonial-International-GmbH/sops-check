{
  "$schema": "https://json-schema.org/draft-07/schema",
  "additionalProperties": false,
  "definitions": {
    "allOfRule": {
      "additionalProperties": false,
      "description": "Asserts that all of the nested rules match.",
      "properties": {
        "allOf": {
          "$ref": "#/definitions/rules"
        }
      },
      "required": [
        "allOf"
      ],
      "type": "object"
    },
    "anyOfRule": {
      "additionalProperties": false,
      "description": "Asserts that at least one of the nested rules matches.",
      "properties": {
        "anyOf": {
          "$ref": "#/definitions/rules"
        }
      },
      "required": [
        "anyOf"
      ],
      "type": "object"
    },
    "matchRule": {
      "additionalProperties": false,
      "description": "A rule for matching trust anchors.",
      "properties": {
        "match": {
          "description": "Defines the pattern to match trust anchors against. Can be an exact string or a regular expression.",
          "type": "string"
        }
      },
      "required": [
        "match"
      ],
      "type": "object"
    },
    "notRule": {
      "additionalProperties": false,
      "description": "Inverts the matching behaviour of a rule.",
      "properties": {
        "not": {
          "$ref": "#/definitions/rule"
        }
      },
      "required": [
        "not"
      ],
      "type": "object"
    },
    "oneOfRule": {
      "additionalProperties": false,
      "description": "Asserts that exactly one of the nested rules matches.",
      "properties": {
        "oneOf": {
          "$ref": "#/definitions/rules"
        }
      },
      "type": "object"
    },
    "rule": {
      "description": "Defines single matching rule.",
      "oneOf": [
        {
          "$ref": "#/definitions/allOfRule"
        },
        {
          "$ref": "#/definitions/anyOfRule"
        },
        {
          "$ref": "#/definitions/matchRule"
        },
        {
          "$ref": "#/definitions/notRule"
        },
        {
          "$ref": "#/definitions/oneOfRule"
        }
      ]
    },
    "rules": {
      "description": "A list of matching rules.",
      "items": {
        "$ref": "#/definitions/rule"
      },
      "type": "array"
    }
  },
  "description": "Schema of the sops-compliance-checker configuration file",
  "properties": {
    "rules": {
      "$ref": "#/definitions/rules"
    }
  },
  "title": "sops-compliance-checker configuration",
  "type": "object"
}
